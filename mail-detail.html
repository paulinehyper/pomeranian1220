<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>메일 상세보기</title>
  <link rel="stylesheet" href="style.css">
  <style>
        .close-x-btn {
          position: absolute;
          top: 16px;
          right: 24px;
          width: 36px;
          height: 36px;
          background: transparent;
          border: none;
          color: #000000;
          font-size: 2em;
          font-weight: bold;
          cursor: pointer;
          z-index: 20;
          -webkit-app-region: no-drag;
          transition: color 0.2s;
        }
        .close-x-btn:hover {
          color: #0093b4;
          background: #e6fff7;
        }
    body { background: #f8fffd; margin: 0; padding: 0; font-family: 'Segoe UI', 'Malgun Gothic', Arial, sans-serif; }
    .mail-detail-wrap {
      max-width: 600px;
      margin: 40px auto;
      padding: 0 0 32px 0;
      border-radius: 14px;
      box-shadow: 0 4px 24px #00000022;
      background: #fff;
      display: flex;
      flex-direction: column;
      gap: 18px;
      overflow: hidden;
    }
    .mail-detail-header {
      height: 56px;
      background: linear-gradient(90deg, #0093b4 80%, #000000 100%);
      display: flex;
      align-items: center;
      padding: 0 24px;
      font-size: 1.18em;
      font-weight: bold;
      color: #fff;
      border-top-left-radius: 14px;
      border-top-right-radius: 14px;
      -webkit-app-region: drag;
      user-select: none;
      cursor: move;
      box-shadow: 0 2px 8px #0093b422;
      letter-spacing: 0.5px;
    }
    .mail-detail-header * {
      -webkit-app-region: no-drag;
    }
    .mail-detail-content {
      padding: 24px 36px 0 36px;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }
    .mail-detail-title { font-size: 1.15em; font-weight: bold; color: #0093b4; margin-bottom: 4px; }
    .mail-detail-meta { color: #888; font-size: 0.98em; margin-bottom: 8px; }
    .mail-detail-body { color: #444; line-height: 1.7; white-space: pre-wrap; font-size: 1.05em; }
    .close-btn { margin-top: 18px; background: #000000; color: #fff; border: none; padding: 8px 24px; border-radius: 8px; font-size: 1em; cursor: pointer; align-self: center; }
  </style>
</head>
<body>
  <div class="mail-detail-wrap">
    <button class="close-x-btn" onclick="window.close()" title="닫기">×</button>
    <div class="mail-detail-header"></div>
    <div class="mail-detail-content">
      <div class="mail-detail-title" id="mailDetailSubject"></div>
      <div class="mail-detail-meta" id="mailDetailMeta"></div>
      <div class="mail-detail-body" id="mailDetailBody"></div>
      <button class="close-btn" onclick="window.close()">닫기</button>
    </div>
    <script>
    // 메일 본문에서 Content-Type 등 헤더와 구분선(--)을 제거하고 실제 내용만 표시
    function cleanMailBody(body) {
      // 1. Content-Type 등 헤더 제거 (줄 전체)
      body = body.replace(/^Content-Type:.*$/gim, '');
      // 2. 구분선(--로 시작하는 줄) 제거
      body = body.replace(/^--.*$/gm, '');
      // 3. charset 등 기타 헤더 제거
      body = body.replace(/^.*charset=.*$/gim, '');
      // 4. 앞뒤 공백 및 빈 줄 제거
      body = body.replace(/^\s*$/gm, '');
      return body.trim();
    }
    // 실제 데이터 연동 시 window.electronAPI 등으로 대체
    const mailBody = document.getElementById('mailDetailBody').innerText || '';
    document.getElementById('mailDetailBody').innerText = cleanMailBody(mailBody);
    </script>
  </div>
  <script>
    // 메일 데이터 받기
    window.onload = function() {
      const params = new URLSearchParams(window.location.search);
      document.getElementById('mailDetailSubject').textContent = params.get('subject') || '';
      document.getElementById('mailDetailMeta').textContent = `${params.get('received_at') || ''} / ${params.get('from_addr') || ''}`;
      document.getElementById('mailDetailBody').textContent = params.get('body') || '본문 없음';
    };
  </script>
</body>
</html>
